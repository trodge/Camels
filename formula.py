# two goods
Qa = Ra*(Rb*(Aa*Ra*Sa + Ab*Rb*Sb - Ia*Ra - Ib*Rb)/(Ra**2*Sa + Rb**2*Sb) - Rb*sqrt(Aa**2*Ra**2*Sa**2 + 2*Aa*Ab*Ra*Rb*Sa*Sb - 2*Aa*Ia*Ra**2*Sa - 2*Aa*Ib*Ra*Rb*Sa +
                                                                                  Ab**2*Rb**2*Sb**2 - 2*Ab*Ia*Ra*Rb*Sb - 2*Ab*Ib*Rb**2*Sb + Ia**2*Ra**2 + 2*Ia*Ib*Ra*Rb + Ib**2*Rb**2 + 2*P*Ra**2*Sa + 2*P*Rb**2*Sb)/(Ra**2*Sa + Rb**2*Sb))/Rb
Qb = Rb*(Aa*Ra*Sa + Ab*Rb*Sb - Ia*Ra - Ib*Rb)/(Ra**2*Sa + Rb**2*Sb) - Rb*sqrt(Aa**2*Ra**2*Sa**2 + 2*Aa*Ab*Ra*Rb*Sa*Sb - 2*Aa*Ia*Ra**2*Sa - 2*Aa*Ib*Ra*Rb*Sa +
                                                                              Ab**2*Rb**2*Sb**2 - 2*Ab*Ia*Ra*Rb*Sb - 2*Ab*Ib*Rb**2*Sb + Ia**2*Ra**2 + 2*Ia*Ib*Ra*Rb + Ib**2*Rb**2 + 2*P*Ra**2*Sa + 2*P*Rb**2*Sb)/(Ra**2*Sa + Rb**2*Sb)
Qa = Ra*(Rb*(Aa*Ra*Sa + Ab*Rb*Sb - Ia*Ra - Ib*Rb)/(Ra**2*Sa + Rb**2*Sb) + Rb*sqrt(Aa**2*Ra**2*Sa**2 + 2*Aa*Ab*Ra*Rb*Sa*Sb - 2*Aa*Ia*Ra**2*Sa - 2*Aa*Ib*Ra*Rb*Sa +
                                                                                  Ab**2*Rb**2*Sb**2 - 2*Ab*Ia*Ra*Rb*Sb - 2*Ab*Ib*Rb**2*Sb + Ia**2*Ra**2 + 2*Ia*Ib*Ra*Rb + Ib**2*Rb**2 + 2*P*Ra**2*Sa + 2*P*Rb**2*Sb)/(Ra**2*Sa + Rb**2*Sb))/Rb
Qb = Rb*(Aa*Ra*Sa + Ab*Rb*Sb - Ia*Ra - Ib*Rb)/(Ra**2*Sa + Rb**2*Sb) + Rb*sqrt(Aa**2*Ra**2*Sa**2 + 2*Aa*Ab*Ra*Rb*Sa*Sb - 2*Aa*Ia*Ra**2*Sa - 2*Aa*Ib*Ra*Rb*Sa +
                                                                              Ab**2*Rb**2*Sb**2 - 2*Ab*Ia*Ra*Rb*Sb - 2*Ab*Ib*Rb**2*Sb + Ia**2*Ra**2 + 2*Ia*Ib*Ra*Rb + Ib**2*Rb**2 + 2*P*Ra**2*Sa + 2*P*Rb**2*Sb)/(Ra**2*Sa + Rb**2*Sb)


# three goods
Qa = Ra*(Aa*Ra*Sa + Ab*Rb*Sb + Ac*Rc*Sc - Ia*Ra - Ib*Rb - Ic*Rc + sqrt(Aa**2*Ra**2*Sa**2 + 2*Aa*Ab*Ra*Rb*Sa*Sb + 2*Aa*Ac*Ra*Rc*Sa*Sc
                                                                       - 2*Aa*Ia*Ra**2*Sa - 2*Aa*Ib*Ra*Rb*Sa - 2*Aa*Ic*Ra*Rc*Sa + Ab**2*Rb**2*Sb**2 + 2*Ab*Ac*Rb*Rc*Sb*Sc - 2*Ab*Ia*Ra*Rb*Sb - 2*Ab*Ib*Rb**2*Sb - 2*Ab*Ic*Rb*Rc*Sb + Ac**2*Rc**2*Sc**2 - 2*Ac*Ia*Ra*Rc*Sc - 2*Ac*Ib*Rb*Rc*Sc - 2*Ac*Ic*Rc**2*Sc + Ia**2*Ra**2 + 2*Ia*Ib*Ra*Rb + 2*Ia*Ic*Ra*Rc + Ib**2*Rb**2 + 2*Ib*Ic*Rb*Rc + Ic**2*Rc**2 + 2*P*Ra**2*Sa + 2*P*Rb**2*Sb + 2*P*Rc**2*Sc))/(Ra**2*Sa + Rb**2*Sb + Rc**2*Sc)
Qb = Rb*(Aa*Ra*Sa + Ab*Rb*Sb + Ac*Rc*Sc - Ia*Ra - Ib*Rb - Ic*Rc + sqrt(Aa**2*Ra**2*Sa**2 + 2*Aa*Ab*Ra*Rb*Sa*Sb + 2*Aa*Ac*Ra*Rc*Sa*Sc
                                                                       - 2*Aa*Ia*Ra**2*Sa - 2*Aa*Ib*Ra*Rb*Sa - 2*Aa*Ic*Ra*Rc*Sa + Ab**2*Rb**2*Sb**2 + 2*Ab*Ac*Rb*Rc*Sb*Sc - 2*Ab*Ia*Ra*Rb*Sb - 2*Ab*Ib*Rb**2*Sb - 2*Ab*Ic*Rb*Rc*Sb + Ac**2*Rc**2*Sc**2 - 2*Ac*Ia*Ra*Rc*Sc - 2*Ac*Ib*Rb*Rc*Sc - 2*Ac*Ic*Rc**2*Sc + Ia**2*Ra**2 + 2*Ia*Ib*Ra*Rb + 2*Ia*Ic*Ra*Rc + Ib**2*Rb**2 + 2*Ib*Ic*Rb*Rc + Ic**2*Rc**2 + 2*P*Ra**2*Sa + 2*P*Rb**2*Sb + 2*P*Rc**2*Sc))/(Ra**2*Sa + Rb**2*Sb + Rc**2*Sc)
Qc = Rc*(Aa*Ra*Sa + Ab*Rb*Sb + Ac*Rc*Sc - Ia*Ra - Ib*Rb - Ic*Rc)/(Ra**2*Sa + Rb**2*Sb + Rc**2*Sc) + Rc*sqrt(Aa**2*Ra**2*Sa**2 + 2*Aa*Ab*Ra*Rb*Sa*Sb + 2*Aa*Ac*Ra*Rc*Sa*Sc - 2*Aa*Ia*Ra**2*Sa - 2*Aa*Ib*Ra*Rb*Sa - 2*Aa*Ic*Ra*Rc*Sa + Ab**2*Rb**2*Sb**2 + 2*Ab*Ac*Rb*Rc*Sb*Sc - 2*Ab*Ia*Ra*Rb *
                                                                                                            Sb - 2*Ab*Ib*Rb**2*Sb - 2*Ab*Ic*Rb*Rc*Sb + Ac**2*Rc**2*Sc**2 - 2*Ac*Ia*Ra*Rc*Sc - 2*Ac*Ib*Rb*Rc*Sc - 2*Ac*Ic*Rc**2*Sc + Ia**2*Ra**2 + 2*Ia*Ib*Ra*Rb + 2*Ia*Ic*Ra*Rc + Ib**2*Rb**2 + 2*Ib*Ic*Rb*Rc + Ic**2*Rc**2 + 2*P*Ra**2*Sa + 2*P*Rb**2*Sb + 2*P*Rc**2*Sc)/(Ra**2*Sa + Rb**2*Sb + Rc**2*Sc)
